# Template file for 'helio-sequencer'
pkgname=helio-sequencer
version=3.12
_gitrev="61f7db380f083b424418d65f4e26addc1370ddea"
revision=1
archs="i686 x86_64"
hostmakedepends="git pkg-config"
makedepends="freetype-devel libX11-devel libXinerama-devel libXrandr-devel libXcursor-devel libXcomposite-devel MesaLib-devel libfreeglut-devel libcurl-devel alsa-lib-devel jack-devel libsigc++-devel"
depends="curl freetype libXinerama libglvnd alsa-lib"
short_desc="One music sequencer for all major platforms, desktop and mobile"
maintainer="IFoundSilentHouse <adeptslab@gmail.com>"
license="GPL-3.0-or-later"
homepage="https://helio.fm/"
changelog="https://github.com/helio-fm/helio-sequencer/blob/develop/CHANGELOG.md"

do_fetch() {
        # commit 61f7db3 is a commit of stable version 3.12
        # helio-sequencer has thirdparty repos in its' github 
        # so we have to use this do_fetch() hack
        git clone --recursive https://github.com/helio-fm/helio-sequencer.git $wrksrc
        cd $wrksrc
        git reset --hard ${_gitrev}
}

do_build() {
        case "$XBPS_TARGET_MACHINE" in
                i686) export CONFIG=Release32 ;;
                x86_64) export CONFIG=Release64 ;;
        esac
        cd $wrksrc/Projects/LinuxMakefile/
        make all strip
        cd $wrksrc/Docs
}

do_install() {
        cd $wrksrc
        vbin Projects/LinuxMakefile/build/helio
}

post_install() {
        cd $wrksrc
        vinstall Projects/Deployment/Linux/Debian/x64/usr/share/applications/Helio.desktop 644 usr/share/applications
        cd $wrksrc/Projects/Deployment/Linux/Debian/x64/usr/share/icons/hicolor/
        vmkdir usr/share/icons/hicolor/
        for _i in 16 32 48 128 256; do
                vinstall ${_i}x${_i}/apps/helio-workstation.png 644 usr/share/icons/hicolor/${_i}x${_i}/apps helio-workstation.png
        done
        cd $wrksrc
        vlicense LICENSE
}

